# FastAPI & Pytest Showcase Project

[![CI](https://github.com/uemurm/Pytest-backend/actions/workflows/ci.yml/badge.svg)](https://github.com/uemurm/Pytest-backend/actions)

A demonstration of a modern Python backend application using FastAPI. This project emphasises best practices in testing, dependency management, and development workflow to create a robust and maintainable codebase.

## Core Technologies

| Category                     | Technology                                   |
|------------------------------|----------------------------------------------|
| **Backend Framework**        | FastAPI                                      |
| **Testing Framework**        | Pytest, `pytest-asyncio`, `pytest-randomly`  |
| **Package & Env Management** | `uv`                                         |
| **Python Tooling**           | `pipx`                                       |
| **Linting**                  | `flake8`                                     |
| **Code Formatting**          | *(Consider adding `black` or `ruff format`)* |
| **CI/CD**                    | GitHub Actions                               |

## Project Philosophy: A Commitment to Modern Development

This project intentionally adopts a modern toolchain to maximise developer experience, performance, and code quality.

-   **`uv` for Speed**: We use `uv` instead of `pip` and `venv`. As a Rust-based tool, it provides near-instantaneous dependency installation and virtual environment creation, dramatically speeding up the development cycle.

-   **`pipx` for Tool Isolation**: Global tools like `uv` are installed via `pipx`. This ensures that development tools are isolated from each other and from project dependencies, preventing "dependency hell" on the developer's machine.

-   **`pytest-randomly` for Robust Tests**: The test suite is executed in a random order on every run. This practice surfaces tests that implicitly depend on execution order, forcing the creation of truly independent and reliable tests.

-   **Deterministic Dependencies**: We manage dependencies using a `requirements.in` file for direct dependencies and a `requirements.txt` file as a lockfile generated by `uv pip compile`. This ensures that every developer and every CI run uses the exact same versions of all packages, guaranteeing reproducibility.

-   **Consistent Line Endings**: A `.gitattributes` file is used to enforce `LF` line endings across all text files. This prevents common issues in cross-platform (Windows, macOS, Linux) development.

## Getting Started

### Prerequisites

-   Python 3.12+
-   `pipx` (for installing `uv`). If you don't have it, install it first:
    ```sh
    py -m pip install --user pipx
    py -m pipx ensurepath
    ```
    *(You may need to restart your terminal after this step.)*

### Installation

1.  **Clone the repository:**
    ```sh
    git clone https://github.com/uemurm/Pytest-backend.git
    cd YOUR_REPOSITORY
    ```

2.  **Install `uv` using `pipx`:**
    ```sh
    pipx install uv
    ```

3.  **Create the virtual environment and install dependencies:**
    `uv` will create a `.venv`, activate it for the current session (on supported shells), and install all packages from the `requirements.txt` lockfile.
    ```sh
    uv sync
    ```
    *(If `uv sync` is not available, or you prefer the manual way: `uv venv`, `.venv\Scripts\activate`, `uv pip install -r requirements.txt`)*

## Development Workflow

### Running the Application

To run the FastAPI application with hot-reloading:
```sh
uvicorn app.main:app --reload
```
The API will be available at `http://127.0.0.1:8000`.

### Running Tests

To run the entire test suite:
```sh
pytest
```
To run tests with a code coverage report:
```sh
pytest --cov=app
```

### Managing Dependencies

Project dependencies are managed with `uv pip compile`.

-   To add or update a direct dependency, edit the **`requirements.in`** file.
-   After editing, regenerate the `requirements.txt` lockfile with:
    ```sh
    uv pip compile requirements.in -o requirements.txt
    ```
-   Finally, install the updated packages into your virtual environment:
    ```sh
    uv sync
    ```

### Committing Changes

This project follows the [Conventional Commits](https://www.conventionalcommits.org/) specification. This leads to a more readable and structured commit history.
```sh
# Example commit types:
# build: Changes that affect the build system or external dependencies
# feat: A new feature
# fix: A bug fix
# docs: Documentation only changes
# refactor: A code change that neither fixes a bug nor adds a feature
# chore: Other changes that don't modify src or test files
```
